<% 
  // Helper function to check permissions
  const hasPermission = (module, permissionType = 'manage') => {
    // Admins have all permissions
    if (typeof isAdmin !== 'undefined' && isAdmin) return true;
    // Check if user has the module and the specific permission
    return typeof userPermissions !== 'undefined' && userPermissions && userPermissions[module] && userPermissions[module][permissionType];
  };
%>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EZ Door || Distributor Management</title>
  <%- include('partials/linkheader.ejs') %>
</head>
<style>
  a#s_show_hide {
    position: absolute;
    top: 50%;
    transform: translateY(20%);
    right: 10px;
    font-size: 14px;
    z-index: 10;
    cursor: pointer;
  }
</style>

<body>
  <span id="pageId" style="display: none">distributor</span>
  <div class="page-wrapper">
    <!------Header END-------->

    <section class="listing-wrapper distributer-wrapper position-relative vh-100">
      <div class="container-fluid px-0 h-100">
        <div class="row mx-0 h-100">
          <div class="col-md-12 px-0">
            <div class="h-100">
              <%- include('partials/sidebar.ejs') %>
                <div class="right-side-block">
                  <%- include('partials/header.ejs') %>

                    <div class="card border-0 bg-transparent">
                      <div class="card-body p-0">
                        <div class="distribute_topbar d-flex align-items-center justify-content-between">
                          <h4 class="title-head">Distributor Management</h4>
                          <% if (hasPermission('Distributor', 'create' )) { %>
                            <a href="add-distributor" class="btn btn-primary" data-bs-toggle="modal"
                              data-bs-target="#adddistributorModal">+ Add Distributor</a>
                            <% } %>
                        </div>
                      </div>
                    </div>

                    <div class="card border-0 bg-transparent">
                      <div class="card-body p-0">
                        <form method="GET" action="/admin/distributor-management" class="">
                          <div class="bg-white p-4">
                            <div class="row">
                              <div class="col-md-3">
                                <div class="form-group">
                                  <label for="">Region</label>
                                  <select name="region" class="form-control">
                                    <option value="">All Regions</option>
                                    <option value="north" <%=selectedRegion=='north' ? 'selected' : '' %>>North</option>
                                    <option value="south" <%=selectedRegion=='south' ? 'selected' : '' %>>South</option>
                                    <option value="east" <%=selectedRegion=='east' ? 'selected' : '' %>>East</option>
                                    <option value="west" <%=selectedRegion=='west' ? 'selected' : '' %>>West</option>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-3 mt-4 mt-md-0">
                                <div class="form-group">
                                  <label for="">Status</label>
                                  <select name="status" class="form-control">
                                    <option value="">Select Status</option>
                                    <% status.forEach(function(element) { %>
                                      <option value="<%= element._id %>" <%=selectedStatus==element._id ? 'selected'
                                        : '' %>>
                                        <%= element.name %>
                                      </option>
                                      <% }); %>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-4 mt-4">
                                <button type="submit" class="btn btn-primary">
                                  Search
                                </button>
                                <button type="button" class="btn btn-default ms-2" onclick="clearQueryParams()">
                                  Clear
                                </button>
                              </div>
                              <!-- <div class="col-md-3 mt-4 mt-md-0">
                            <div class="form-group">
                              <label for="">Ratings</label>
                              <select name="" class="form-control">
                                <option value="">All Ratings</option>
                                <option value="">High Performance</option>
                                <option value="">Average</option>
                                <option value="">Low Performance</option>
                              </select>
                            </div>
                          </div> -->

                              <!-- <div class="col-md-3 mt-4 mt-md-0">
                            <div class="form-group">
                              <label for="">Region</label>
                              <input
                                type="text"
                                class="form-control"
                                placeholder="Search distributors..."
                              />
                            </div>
                          </div> -->
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>

                    <div class="card border-0 bg-transparent">
                      <div class="card-body p-0">
                        <div class="distributor-table bg-white p-4">
                          <div class="table-responsive">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>Name</th>
                                  <th>Email</th>
                                  <th>Mobile</th>
                                  <th>Type</th>
                                  <th>State</th>
                                  <th>Region</th>
                                  <th>Status</th>
                                  <th>Actions</th>
                                </tr>
                              </thead>
                              <tbody>
                                <% distributors.forEach(function(distributor, index) { %>
                                  <tr>
                                    <td>
                                      <%= distributor.name %>
                                    </td>
                                    <td>
                                      <%= distributor.email ? distributor.email : '--' %>
                                    </td>
                                    <td>
                                      <%= distributor.mobile_number ? distributor.mobile_number : '--' %>
                                    </td>
                                    <td>
                                      <%= distributor.distributor_type ? distributor.distributor_type.name : '--' %>
                                    </td>
                                    <td>
                                      <%= distributor.state ? distributor.state : '--' %>
                                    </td>
                                    <td>
                                      <%= distributor.region ? distributor.region.charAt(0).toUpperCase() +
                                        distributor.region.slice(1) : '--' %>
                                    </td>

                                    <td>
                                      <label class="status">
                                        <%= distributor.status ? 'Active' : 'Inactive' %> %>
                                      </label>
                                    </td>
                                    <!-- <td>2 hours ago</td> -->
                                    <td>
                                      <div class="">
                                        <a href="#" id="edit_btn" data-bs-toggle="modal"
                                          data-bs-target="#editdistributorModal" data-id="<%= distributor._id %>"
                                          data-model="<%= JSON.stringify(distributor) %>"
                                          class="edit-text btn btn-primary text-white edit-btn">Edit</a>
                                        <!-- <a
                                      class="btn btn-primary text-white"
                                      href="#"
                                      >View</a
                                    > -->
                                        <a href="#" class="delete-btn red-status btn btn-primary text-white"
                                          data-id="<%=distributor._id%>">Delete</a>
                                      </div>
                                    </td>
                                  </tr>
                                  <% }); %>
                              </tbody>
                            </table>
                          </div>
                          <div class="d-flex align-items-center justify-content-between">
                            <p>
                              Showing <%= Math.min(currentPage * pageSize, totalItems) %> of <%= totalItems %> entries
                            </p>

                            <nav aria-label="Page navigation">
                              <ul class="pagination mb-0">
                                <!-- Previous Button -->
                                <li class="page-item <%= currentPage <= 1 ? 'disabled' : '' %>">
                                  <a class="page-link" href="?page=<%= currentPage - 1 %>">Previous</a>
                                </li>

                                <% let startPage=Math.max(1, currentPage - 1); let endPage=Math.min(totalPages,
                                  startPage + 2); // Adjust startPage if we're near the end if(endPage - startPage < 2)
                                  { startPage=Math.max(1, endPage - 2); } %>
                                  <% for (let i=startPage; i <=endPage; i++) { %>
                                    <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                                      <a class="page-link" href="?page=<%= i %>">
                                        <%= i %>
                                      </a>
                                    </li>
                                    <% } %>

                                      <!-- Next Button -->
                                      <li class="page-item <%= currentPage >= totalPages ? 'disabled' : '' %>">
                                        <a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a>
                                      </li>
                              </ul>
                            </nav>
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!------listing-wrapper END-------->
  </div>
  <!------Page-wrapper END-------->
  <%- include('partials/linkfooter.ejs') %>

    <!-- Add Modal -->
    <div class="modal fade" id="adddistributorModal" tabindex="-1" aria-labelledby="adddistributorModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="adddistributorModalLabel">
              Add New Distributor
            </h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="addDistributorForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="">Full Name</label>
                    <input type="text" id="name" name="name" class="form-control" placeholder="Name" />
                  </div>
                </div>

                <div class="col-md-6 mt-4 mt-md-0">
                  <div class="form-group">
                    <label for="">Firm Name</label>
                    <input type="text" id="firm_name" name="firm_name" class="form-control" placeholder="Name" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Email Address</label>
                    <input type="email" id="email" class="form-control" name="email" placeholder="Enter Email" />
                  </div>
                </div>
                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Type</label>
                    <select name="distributor_type" id="distributor_type" class="form-control">
                      <option value="">Select Type</option>
                      <% role.forEach(r=> { %>
                        <option value="<%= r._id %>" <%=r._id.toString()===selectedDistributorType ? "selected" : "" %>>
                          <%= r.name %>
                        </option>
                        <% }); %>
                    </select>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Mobile</label>
                    <input type="text" id="mobile_number" name="mobile_number" class="form-control"
                      placeholder="Phone Number" maxlength="10"
                      oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);" required />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Address</label>
                    <input type="text" id="address" name="address" class="form-control" placeholder="Address" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">State</label>
                    <select id="state" name="state" class="form-control">
                      <option value="">Select State</option>
                      <option value="Andhra Pradesh">Andhra Pradesh</option>
                      <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                      <option value="Assam">Assam</option>
                      <option value="Bihar">Bihar</option>
                      <option value="Chhattisgarh">Chhattisgarh</option>
                      <option value="Goa">Goa</option>
                      <option value="Gujarat">Gujarat</option>
                      <option value="Haryana">Haryana</option>
                      <option value="Himachal Pradesh">Himachal Pradesh</option>
                      <option value="Jharkhand">Jharkhand</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Madhya Pradesh">Madhya Pradesh</option>
                      <option value="Maharashtra">Maharashtra</option>
                      <option value="Manipur">Manipur</option>
                      <option value="Meghalaya">Meghalaya</option>
                      <option value="Mizoram">Mizoram</option>
                      <option value="Nagaland">Nagaland</option>
                      <option value="Odisha">Odisha</option>
                      <option value="Punjab">Punjab</option>
                      <option value="Rajasthan">Rajasthan</option>
                      <option value="Sikkim">Sikkim</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Telangana">Telangana</option>
                      <option value="Tripura">Tripura</option>
                      <option value="Uttar Pradesh">Uttar Pradesh</option>
                      <option value="Uttarakhand">Uttarakhand</option>
                      <option value="West Bengal">West Bengal</option>
                      <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                      <option value="Chandigarh">Chandigarh</option>
                      <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli
                        and Daman and Diu</option>
                      <option value="Delhi">Delhi</option>
                      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                      <option value="Ladakh">Ladakh</option>
                      <option value="Lakshadweep">Lakshadweep</option>
                      <option value="Puducherry">Puducherry</option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">City</label>
                    <input type="text" id="city" name="city" class="form-control" placeholder="City" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Pin Code</label>
                    <input type="text" id="pincode" name="pincode" class="form-control" placeholder="Pin Code"
                      maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 6);" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Region</label>
                    <select name="region" id="region" class="form-control">
                      <option value="">Select Region</option>
                      <option value="north">North</option>
                      <option value="south">South</option>
                      <option value="east">East</option>
                      <option value="west">West</option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group position-relative">
                    <label for="">Password</label>
                    <input id="password" name="password" type="password" class="form-control password"
                      placeholder="Enter your password" />
                    <a id="s_show_hide" onclick="show();"><i class="fa-regular fa-eye-slash"></i></a>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group position-relative">
                    <label for="">Confirm Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" class="form-control password"
                      placeholder="Enter your confirm password" />
                    <a id="s_show_hide" onclick="show();"><i class="fa-regular fa-eye-slash"></i></a>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary" id="add-btn">
                    Submit
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editdistributorModal" tabindex="-1" aria-labelledby="editdistributorModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="editdistributorModalLabel">
              Edit Distributor
            </h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editform">
              <input type="hidden" id="editid" name="editid" />
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="">Full Name</label>
                    <input type="text" id="edit_name" name="edit_name" class="form-control" placeholder="Name" />
                  </div>
                </div>

                <div class="col-md-6 mt-4 mt-md-0">
                  <div class="form-group">
                    <label for="">Firm Name</label>
                    <input type="text" id="edit_firm_name" name="edit_firm_name" class="form-control"
                      placeholder="Name" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Email Address</label>
                    <input type="email" id="edit_email" class="form-control" name="edit_email"
                      placeholder="Enter Email" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Type</label>
                    <select name="edit_distributor_type" id="edit_distributor_type" class="form-control">
                      <option value="">Select Type</option>
                      <% role.forEach(r=> { %>
                        <option value="<%= r._id %>" <%=r._id.toString()===selectedDistributorType ? "selected" : "" %>>
                          <%= r.name %>
                        </option>
                        <% }); %>
                    </select>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Mobile</label>
                    <input type="text" id="edit_mobile_number" name="edit_mobile_number" class="form-control"
                      placeholder="Phone Number" maxlength="10"
                      oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);" required />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Address</label>
                    <input type="text" id="edit_address" name="edit_address" class="form-control"
                      placeholder="Address" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">State</label>
                    <select id="edit_state" name="edit_state" class="form-control">
                      <option value="">Select State</option>
                      <option value="Andhra Pradesh">Andhra Pradesh</option>
                      <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                      <option value="Assam">Assam</option>
                      <option value="Bihar">Bihar</option>
                      <option value="Chhattisgarh">Chhattisgarh</option>
                      <option value="Goa">Goa</option>
                      <option value="Gujarat">Gujarat</option>
                      <option value="Haryana">Haryana</option>
                      <option value="Himachal Pradesh">Himachal Pradesh</option>
                      <option value="Jharkhand">Jharkhand</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Madhya Pradesh">Madhya Pradesh</option>
                      <option value="Maharashtra">Maharashtra</option>
                      <option value="Manipur">Manipur</option>
                      <option value="Meghalaya">Meghalaya</option>
                      <option value="Mizoram">Mizoram</option>
                      <option value="Nagaland">Nagaland</option>
                      <option value="Odisha">Odisha</option>
                      <option value="Punjab">Punjab</option>
                      <option value="Rajasthan">Rajasthan</option>
                      <option value="Sikkim">Sikkim</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Telangana">Telangana</option>
                      <option value="Tripura">Tripura</option>
                      <option value="Uttar Pradesh">Uttar Pradesh</option>
                      <option value="Uttarakhand">Uttarakhand</option>
                      <option value="West Bengal">West Bengal</option>
                      <option value="Andaman and Nicobar Islands">Andaman and Nicobar
                        Islands</option>
                      <option value="Chandigarh">Chandigarh</option>
                      <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar
                        Haveli and Daman and Diu</option>
                      <option value="Delhi">Delhi</option>
                      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                      <option value="Ladakh">Ladakh</option>
                      <option value="Lakshadweep">Lakshadweep</option>
                      <option value="Puducherry">Puducherry</option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">City</label>
                    <input type="text" id="edit_city" name="edit_city" class="form-control" placeholder="City" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Pin Code</label>
                    <input type="text" id="edit_pincode" name="edit_pincode" class="form-control" placeholder="Pin Code"
                      maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 6);" />
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group">
                    <label for="">Region</label>
                    <select name="edit_region" id="edit_region" class="form-control">
                      <option value="">Select Region</option>
                      <option value="north">North</option>
                      <option value="south">South</option>
                      <option value="east">East</option>
                      <option value="west">West</option>
                    </select>
                  </div>
                </div>

                <!-- <div class="col-md-6 mt-4">
                  <div class="form-group position-relative">
                    <label for="">Password</label>
                    <input
                      id="password"
                      name="password"
                      type="password"
                      class="form-control password"
                      placeholder="Enter your password"
                    />
                    <a id="s_show_hide" onclick="show();"
                      ><i class="fa-regular fa-eye-slash"></i
                    ></a>
                  </div>
                </div>

                <div class="col-md-6 mt-4">
                  <div class="form-group position-relative">
                    <label for=""> Confirm Password</label>
                    <input
                      type="password"
                      id="confirm_password"
                      name="confirm_password"
                      class="form-control password"
                      placeholder="Enter your confirm password"
                    />
                    <a id="s_show_hide" onclick="show();"
                      ><i class="fa-regular fa-eye-slash"></i
                    ></a>
                  </div>
                </div> -->
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary" id="edit-submit-btn">
                    Submit
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script>
      //#region Add User
      var addform = $("#addDistributorForm");
      addform.on("submit", submitFormHandler);

      function submitFormHandler(e) {
        e.preventDefault();

        var formData = getFormData(addform);

        // DO POST
        $.ajax({
          type: "POST",
          contentType: "application/json",
          url: "/admin/create-distributor",
          data: JSON.stringify(formData),
          success: (res) => {
            renderToast({
              message: res.message,
              icon: "success",
            });
            setTimeout(() => {
              window.location.reload();
            }, 1000);
          },
          error: (res) => {
            console.error(res);

            const errorMessage =
              res.responseJSON && res.responseJSON.message
                ? res.responseJSON.message
                : "Something went wrong";

            renderToast({
              message: errorMessage,
              icon: "warning", // Change icon to "warning" instead of "error"
            });
          },
        });
      }
      //#endregion Add User
    </script>

    <script>
      //#region edit User
      $(document).on("click", "#edit_btn", function (e) {
        var data = $(this).attr("data-model");
        data = JSON.parse(data);

        $("#editid").val(data._id);
        $("#edit_name").val(data.name);
        $("#edit_firm_name").val(data.firm_name);
        $("#edit_email").val(data.email);
        $("#edit_distributor_type").val(data.distributor_type ? data.distributor_type._id : "");
        $("#edit_mobile_number").val(data.mobile_number);
        $("#edit_address").val(data.address);
        $("#edit_state").val(data.state);
        $("#edit_city").val(data.city);
        $("#edit_pincode").val(data.pincode);
        $("#edit_region").val(data.region);
        // $("#edit_password").val(data.password);
        // $("#edit_confirm_password").val(data.confirm_password);
      });

      var editform = $("#editform");
      editform.on("submit", submitFormHandler);

      function submitFormHandler(e) {
        e.preventDefault();

        var formData = getFormData(editform);

        // DO POST
        $.ajax({
          type: "POST",
          contentType: "application/json",
          url: "/admin/update-distributor",
          data: JSON.stringify(formData),
          success: (res) => {
            renderToast({
              message: res.message,
              icon: "success",
            });
            setTimeout(() => {
              window.location.reload();
            }, 1000);
          },
          error: (res) => {
            console.error(res);
            renderToast({
              message: res.message,
              icon: "error",
            });
          },
        });
      }

      //#endregion Edit User
    </script>

    <script>
      let selectedDistributors = [];
      $(document).ready(function () {
        $(".form-check-input").on("change", function () {
          const value = $(this).val();
          if ($(this).is(":checked")) {
            if (!selectedDistributors.includes(value)) {
              selectedDistributors.push(value);
            }
          } else {
            // Remove value
            selectedDistributors = selectedDistributors.filter(
              (item) => item !== value
            );
          }
          if (selectedDistributors.length == 0) {
            $(".edit-btn").show();
          } else {
            $(".edit-btn").hide();
          }
        });

        $(".delete-btn").on("click", function (e) {
          const id = $(this).data("id");
          if (selectedDistributors.length == 0) {
            if (confirm("Do you really want to delete this record")) {
              $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "/admin/delete-distributor",
                data: JSON.stringify({
                  id: id,
                }),
                success: (res) => {
                  renderToast({
                    message: res.message,
                    icon: "success",
                  });
                  setTimeout(() => {
                    window.location.reload();
                  }, 1000);
                },
                error: (res) => {
                  renderToast({
                    message: res.message,
                    icon: "error",
                  });
                  console.error(res);
                },
              });
            }
          } else {
            $.ajax({
              type: "POST",
              contentType: "application/json",
              url: "/admin/delete-distributors",
              data: JSON.stringify(selectedDistributors),
              success: (res) => {
                renderToast({
                  message: res.message,
                  icon: "success",
                });
                setTimeout(() => {
                  window.location.reload();
                }, 1000);
              },
              error: (res) => {
                renderToast({
                  message: res.message,
                  icon: "error",
                });
                console.error(res);
              },
            });
          }
        });
      });
    </script>
    <script>
      function clearQueryParams() {
        // Reset select fields
        $("select[name='region']").val("");
        $("select[name='status']").val("");

        // Reload the page without any query parameters
        const url = window.location.origin + window.location.pathname;
        window.location.href = url; // Triggers reload with no query
      }
    </script>
</body>

</html>