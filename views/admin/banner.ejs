<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EZ Door || Banners</title>
    <%- include('partials/linkheader.ejs') %>
  </head>

  <body>
    <div class="page-wrapper">
      <section
        class="listing-wrapper uploadsributer-wrapper position-relative vh-100"
      >
        <div class="container-fluid px-0 h-100">
          <div class="row mx-0 h-100">
            <div class="col-md-12 px-0">
              <div class="h-100">
                <%- include('partials/sidebar.ejs') %>
                <div class="right-side-block">
                  <%- include('partials/header.ejs') %>

                  <div class="card border-0 bg-transparent">
                    <div class="card-body p-0">
                      <div class="p-4 bg-white rounded-3">
                        <h4>Banners</h4>
                        <form id="addBannerForm">
                          <!-- Home Banner Top -->
                          <div class="col-lg-12 mb-5 mt-4">
                            <label class="form-label">Home Banner 1</label>
                            <div class="mb-3">
                              <input
                                type="file"
                                class="form-control"
                                id="home_banner_1_image"
                                name="home_banner_1_image"
                                accept=".jpg, .jpeg, .png"
                                placeholder="Upload Image"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="form-label">Title</label>
                              <input
                                type="text"
                                class="form-control"
                                id="home_banner_1_title"
                                name="home_banner_1_title"
                                placeholder="Enter Title"
                                value="<%= home_banner_1_title %>"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="form-label">Description</label>
                              <textarea
                                type="text"
                                class="form-control"
                                id="home_banner_1_description"
                                name="home_banner_1_description"
                                placeholder="Enter Description"
                              ><%= home_banner_1_description %></textarea
                              >
                            </div>
                          </div>

                          <!-- Home Banner 2 -->
                          <div class="col-lg-12 mb-5">
                            <label class="form-label">Home Banner 2</label>
                            <div class="mb-3">
                              <input
                                type="file"
                                class="form-control"
                                id="home_banner_2_image"
                                name="home_banner_2_image"
                                accept=".jpg, .jpeg, .png"
                                placeholder="Upload Image"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="form-label">Title</label>
                              <input
                                type="text"
                                class="form-control"
                                id="home_banner_2_title"
                                name="home_banner_2_title"
                                placeholder="Enter Title"
                                value="<%= home_banner_2_title %>"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="form-label">Description</label>
                              <textarea
                                type="text"
                                class="form-control"
                                id="home_banner_2_description"
                                name="home_banner_2_description"
                                placeholder="Enter Description"
                              ><%= home_banner_2_description %></textarea
                              >
                            </div>
                          </div>
                          <!-- Submit Button -->
                          <div
                              class="col-md-6 ms-auto text-md-end text-center mt-4"
                            >
                              <button type="submit" class="btn btn-primary">
                                Save Changes
                              </button>
                            </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!------listing-wrapper END-------->
    </div>
    <!------Page-wrapper END-------->
    <%- include('partials/linkfooter.ejs') %>

    <script>
      // Initialize the form
      var addBannerform = $("#addBannerForm");
      addBannerform.on("submit", submitFormHandler);

      // Function to handle form submission
      function submitFormHandler(e) {
        e.preventDefault();

        // Validate form fields
        const banner1 = $("#home_banner_1_image")[0].files[0];
    const banner2 = $("#home_banner_2_image")[0].files[0];

    // Individual checks
    if (!banner1) {
      renderToast({
        message: "Please upload Home Banner 1 image.",
        icon: "warning",
      });
      return;
    }

    if (!banner2) {
      renderToast({
        message: "Please upload Home Banner 2 image.",
        icon: "warning",
      });
      return;
    }

        var formData = new FormData(addBannerform[0]);

        // AJAX POST request
        $.ajax({
          type: "POST",
          cache: false,
          enctype: "multipart/form-data",
          processData: false,
          contentType: false,
          url: "/admin/add-banner",
          data: formData,
          success: (res) => {
            renderToast({
              message: res.message,
              icon: "success",
            });
            setTimeout(() => {
              window.location.reload();
            }, 1000);
          },
          error: (res) => {
            console.error(res);
          },
        });
      }
    </script>
  </body>
</html>
